<nz-spin [nzSpinning]="isSpinning">
<!-- rank -->
<div *ngIf="name==='rank'" class="panel">
    <div class="header">
        {{ 'PANEL.RANK.MY_TEAM' | translate }}
        &nbsp;&nbsp;&nbsp;&nbsp;
        <span>{{ 'TABLE.COMMITTEE.NEXT_UPDATE_BLOCK' | translate }}: {{ effectBlock }}</span>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <button nz-button nzType="default" nzSize="small" nzShape="circle" (click)="tipClick(1)" class="genaro-question-button">
            <i class="anticon genaro-question"></i>
        </button>
    </div>
    <form nz-form class="ant-advanced-search-form">
        <div nz-row [nzGutter]="24">
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label><i class="rank-icon"></i>{{ 'PANEL.RANK.RANK' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ accountTeamInfo.order + 1 || '300+' }}
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label><i class="team-icon"></i>{{ 'PANEL.RANK.TEAM_NAME' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ accountTeamInfo.shortAddr }}
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label><i class="sentinel-icon"></i>{{ 'PANEL.RANK.SENTINEL_SCORE' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ accountTeamInfo.currentSentinel * 10000 | formatSentinel }}
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-control>
                        <button style="width: 140px" nz-button [nzType]="'primary'" (click)="showCurrentTeam=!showCurrentTeam;">{{ 'PANEL.RANK.VIEW_MEMBER' | translate }}</button>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label>{{ 'PANEL.RANK.GNX_STAKE' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ accountTeamInfo.currentStake }}
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label>{{ 'PANEL.RANK.SPACE_USED' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ accountTeamInfo.currentDataSize | formatSize }}
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label>{{ 'PANEL.RANK.MEMBER_COUNT' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ (accountTeamInfo.subFarmers || []).length }} / 10
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
        </div>
    </form>
    <nz-table *ngIf="showCurrentTeam" #currentTeamTable [nzData]="accountTeamInfo.subFarmers" nzShowPagination="false" [nzPageSize]="31"
        class="tx" [nzScroll]='{ y: "240px"}' [nzNoResult]="'TABLE.NO_DATA' | translate">
        <thead>
            <tr>
                <!-- <th nzWidth="15%">{{ 'TABLE.COMMITTEE.NAME' | translate }}</th> -->
                <th nzWidth="45%">{{ 'TABLE.COMMITTEE.ADDRESS' | translate }}</th>
                <th nzWidth="15%">{{ 'TABLE.COMMITTEE.STAKE' | translate }}</th>
                <th nzWidth="20%">{{ 'TABLE.COMMITTEE.SPACE' | translate }}</th>
                <th nzWidth="20%">{{ 'TABLE.COMMITTEE.SENTINEL' | translate }}</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let data of currentTeamTable.data" [class]="currentWalletAddr === data.address ? 'self' : ''">
                <!-- <td nzWidth="15%">{{data.nickName}}</td> -->
                <td nzWidth="45%">{{data.address | longAddr | shortAddr}}</td>
                <td nzWidth="15%">{{data.stake}}</td>
                <td nzWidth="20%">{{data.data_size | formatSize}}</td>
                <td nzWidth="20%">{{data.sentinel * 10000 | formatSentinel }}</td>
            </tr>
        </tbody>
    </nz-table>
</div>

<!-- committee -->
<div *ngIf="name==='committee'" class="panel">
    <div class="header">
        {{ 'PANEL.RANK.MY_TEAM' | translate }}
        &nbsp;&nbsp;&nbsp;&nbsp;
        <span>{{ 'TABLE.COMMITTEE.NEXT_UPDATE_BLOCK' | translate }}: {{ effectBlock }}</span>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <button nz-button nzType="default" nzSize="small" nzShape="circle" (click)="tipClick(2)" class="genaro-question-button">
            <i class="anticon genaro-question"></i>
        </button>
    </div>
    <form nz-form class="ant-advanced-search-form">
        <div nz-row [nzGutter]="24">
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label><i class="rank-icon"></i>{{ 'PANEL.RANK.RANK' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ pendingTeamInfo.pendingOrder + 1 || '300+' }}
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label><i class="team-icon"></i>{{ 'PANEL.RANK.TEAM_NAME' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ pendingTeamInfo.shortAddr }}
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label><i class="sentinel-icon"></i>{{ 'PANEL.RANK.SENTINEL_SCORE' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ pendingTeamInfo.pendingSentinel * 10000 | formatSentinel }}
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-control>
                        <button style="width: 140px" nz-button [nzType]="'primary'" (click)="showApplyTeam=false;showPendingTeam=!showPendingTeam;">{{ 'PANEL.RANK.VIEW_MEMBER' | translate }}</button>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label>{{ 'PANEL.RANK.GNX_STAKE' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ pendingTeamInfo.pendingStake }}
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label>{{ 'PANEL.RANK.SPACE_USED' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ pendingTeamInfo.pendingDataSize | formatSize }}
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-label>{{ 'PANEL.RANK.MEMBER_COUNT' | translate }}</nz-form-label>
                    <nz-form-control>
                        <nz-form-text>
                            {{ (pendingTeamInfo.pendingSubFarmers || []).length }} / 10
                        </nz-form-text>
                    </nz-form-control>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="6">
                <nz-form-item nzFlex>
                    <nz-form-control>
                        <nz-badge nzDot *ngIf="hasTempSubAccount">
                            <button style="width: 140px" nz-button [nzType]="'primary'" (click)="showPendingTeam=false;showApplyTeam=!showApplyTeam;">{{ 'PANEL.RANK.APPLICATION_RECORD' | translate }}</button>
                        </nz-badge>
                        <button *ngIf="!hasTempSubAccount" style="width: 140px" nz-button [nzType]="'primary'" (click)="showPendingTeam=false;showApplyTeam=!showApplyTeam;">{{ 'PANEL.RANK.APPLICATION_RECORD' | translate }}</button>
                    </nz-form-control>
                </nz-form-item>
            </div>
        </div>
    </form>
    <nz-table *ngIf="showPendingTeam" #pendingTeamTable [nzData]="pendingTeamInfo.pendingSubFarmers" nzShowPagination="false" [nzPageSize]="31"
        class="tx" [nzScroll]='{ y: "240px"}' [nzNoResult]="'TABLE.NO_DATA' | translate">
        <thead>
            <tr>
                <th nzWidth="30%">{{ 'TABLE.COMMITTEE.ADDRESS' | translate }}</th>
                <th nzWidth="15%">{{ 'TABLE.COMMITTEE.STAKE' | translate }}</th>
                <th nzWidth="15%">{{ 'TABLE.COMMITTEE.SPACE' | translate }}</th>
                <th nzWidth="20%">{{ 'TABLE.COMMITTEE.SENTINEL' | translate }}</th>
                <th nzWidth="20%">{{ 'TABLE.COMMITTEE.RELIEVE' | translate }}</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let data of pendingTeamTable.data" [class]="currentWalletAddr === data.address ? 'self' : ''">
                <td nzWidth="30%">{{data.address | longAddr | shortAddr}}</td>
                <td nzWidth="15%">{{data.stake}}</td>
                <td nzWidth="15%">{{data.data_size | formatSize}}</td>
                <td nzWidth="20%">{{data.sentinel * 10000 | formatSentinel }}</td>
                <td nzWidth="20%">
                    <button nz-button *ngIf="data.showRelieve" nzType="primary" nzSize="small" (click)="action.emit(['relieve',data])">{{ 'TABLE.COMMITTEE.RELIEVE' | translate }}</button>
                </td>
            </tr>
        </tbody>
    </nz-table>

    <nz-table *ngIf="showApplyTeam" #applyTeamTable [nzData]="pendingTeamInfo.tempAccounts" nzShowPagination="false" [nzPageSize]="31"
        class="tx" [nzScroll]='{ y: "240px"}' [nzNoResult]="'TABLE.NO_DATA' | translate">
        <thead>
            <tr>
                <th nzWidth="30%">{{ 'TABLE.COMMITTEE.ADDRESS' | translate }}</th>
                <th nzWidth="20%">{{ 'TABLE.COMMITTEE.STAKE' | translate }}</th>
                <th nzWidth="20%">{{ 'TABLE.COMMITTEE.SPACE' | translate }}</th>
                <th nzWidth="15%">{{ 'TABLE.COMMITTEE.SENTINEL' | translate }}</th>
                <th nzWidth="15%">{{ 'TABLE.COMMITTEE.AGREE' | translate }}</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let data of applyTeamTable.data" [class]="currentWalletAddr === data.address ? 'self' : ''">
                <td nzWidth="30%">{{data.address | longAddr | shortAddr}}</td>
                <td nzWidth="20%">{{data.stake}}</td>
                <td nzWidth="20%">{{data.data_size | formatSize}}</td>
                <td nzWidth="15%">{{data.sentinel * 10000 | formatSentinel }}</td>
                <td nzWidth="15%">
                    <button *ngIf="!data.flag" style="width: 60px" nz-button nzType="primary" nzSize="small" (click)="action.emit(['agree',data])">{{ 'TABLE.COMMITTEE.AGREE' | translate }}</button>
                    <button *ngIf="data.flag" style="width: 60px" nz-button nzType="primary" nzSize="small" disabled="true">{{ 'TABLE.COMMITTEE.AGREED' | translate }}</button>
                </td>
            </tr>
        </tbody>
    </nz-table>
</div>
</nz-spin>

<app-dialog [(name)]="tipDialogName" [opt]="tipOpt"></app-dialog>